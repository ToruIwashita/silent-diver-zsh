local dest
local -a args
args=("${(z)BUFFER}")

dest=${${args[$#args]}//\\/}
[[ ! -d $dest ]] && dest=$dest:h

if (( ! $#dest )) || [[ $dest == '.' ]]; then
  zle -I
  return
fi

if [[ $options[autocd] != on ]]; then
  BUFFER="cd $dest"
else
  BUFFER=$dest
fi

zle accept-line

# vim: ft=zsh
